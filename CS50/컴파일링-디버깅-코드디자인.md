# 컴파일링, 디버깅, 코드 디자인

<br/>

## 컴파일링

프로그램을 실행할 때 일어나는 일

- 전처리
- 컴파일링
- 어셈블링
- 링킹

### 전처리(Precompile)

전처리기에 의해 수행된다. **실질적인 컴파일이 이루어지기 전 처리해야 할 것들을 처리한다.**

예를 들어, c언어의 #include는 전처리기에게 다른 파일의 내용을 포함시키라고 알려준다. 전처리기는 새로운 파일을 생성하고, #include된 파일의 내용을 #include 부분에 포함시킨다. 여전히 C 소스 코드의 형태이다.

### 컴파일(Compile)

전처리기가 전처리한 소스 코드를 생성하면, 컴파일러는 **C 코드를 어셈블리어로 컴파일한다.** 즉, 컴퓨터가 이해할 수 있는 언어와 최대한 가까운 프로그램으로 만들어주는 것이다.

어셈블리는 저수준 프로그래밍 언어이며, C보다 연산의 종류가 훨씬 적지만, 여러 연산들이 함께 사용되면 C에서 할 수 있는 모든 것들을 수행할 수 있다.

+) 컴파일이란 용어는 소스 코드에서 오브젝트 코드로 변환하는 전체 과정을 통틀어 일컫기도 하지만, 구체적으로 전처리한 소스 코드를 어셈블리 코드로 변환시키는 단계를 말하기도 한다.

### 어셈블(Assenble)

어셈블리 코드를 오브젝트 코드로 변환시키는 것이다. 이 작업은 어셈블러라는 프로그램이 수행한다.

컴퓨터의 중앙처리장치가 프로그램을 어떻게 수행해야 하는지 알 수 있는 명령어 형태인 **연속된 0과 1들로 바꿔주는 작업**이다.

소스 코드에서 오브젝트 코드로 컴파일되어야 할 파일이 한 개면, 컴파일 작업은 여기서 끝이 난다. 그렇지 않을 땐 링크라는 단계가 추가된다.

### 링크(Link)

만약 프로그램이 math.h나 cs50.h 같은 라이브러리를 포함해 여러 개의 파일로 이루어져 있어 하나의 오브젝트 파일로 합쳐야 하면, 링크라는 단계가 필요하다.

링커는 **여러 개의 다른 오브젝트 코드 파일을 실행 가능한 하나의 오브젝트 코드 파일로 합쳐준다.**

이 네 단계를 거쳐 실행 가능한 파일이 완성된다.

<br/><br/>

## 디버깅

소스코드에서 의도하지 않은 오류나 결과를 **버그**라고 한다.

디버깅(debugging)은 **코드에 있는 버그를 식별하고 고치는 과정**이다. 디버거라는 프로그램으로 디버깅을 한다.

### 오류메시지 확인

help50이라는 cs50에서 제공하는 프로그램으로, help50 make 파일이름 이렇게 명령어를 실행하면, 컴파일시 생기는 오류를 해석해준다. 이 오류를 보고 버그를 수정할 수 있다.

### 출력해보기

오류 메시지로 해결이 되지 않는 경우, 직접 의심이 가는 변수를 printf로 출력하여 확인해 볼 수도 있다.

### IDE에서 제공하는 디버거

CS50 IDE를 사용하면 debug50이라는 프로그램을 사용할 수 있다. (다른 IDE는 다른 방법으로 가능)

소스 코드의 번호 옆을 클릭하면 빨간 점의 브레이크 포인트가 지정된다. debug50 파일명 명령어를 실행하면, 브레이크 포인트에서 소스 실행이 멈춘다. 이후부터 한 줄씩 코드를 실행하며 어디서 문제가 생겼는지 확인할 수 있다.

(다른 IDE에도 이런 기능을 제공한다.)

<br/><br/>

## 코드의 디자인

규모가 큰 프로그램은 여러 사람들이 함께 작업을 진행한다. 내가 기여한 부분이 오류를 발생시키지 않도록 주의해야 하고, 유지보수를 위해 코드 작성 형식도 중요하다.

코드의 정확성을 확인하기 위한 테스트가 필요하다. cs50에서는 check50이라는 프로그램을 제공한다. 이걸로 코드가 잘 수행하는지 자동으로 검사할 수 있다.

코드를 작성할 때는 자신과 다른 사람들이 이해하기 쉽도록 해야한다. 그리고 무엇보다 유지보수하기 쉽도록 해야한다.

코드를 짜놓고 몇 주 뒤 수정하러 왔을 때, 자신이 무엇을 짰는지 이해할 수 없는 상황을 만들지 말아야 한다.

보기 좋은 코드의 기준은 사람들마다 다르다. 같은 스타일로 코드를 작성할 수 있도록 도와주는 도구가 있다. cs50에서는 style50이라는 도구를 제공한다.

✨help50, debug50, check50 같은 프로그램들이 존재하지 않거나, 있어도 디버깅에 큰 도움이 되지 않을 수도 있다. 이럴 땐 직접 곰곰히 생각해보는 수 밖에 없다.

유명한 방법 중에 하나로, **고무 오리**라는 것이 있다. 무언가 대상이 되는 물체를 앞에 두고, 내가 작성한 코드를 한 줄 한 줄 말로 설명해주는 과정을 거친다. 이 과정에서 미처 놓치고 있던 논리적 오류를 찾아낼 수도 있다.

<br/><br/><br/><br/>

## 느낀점

CS50 강의를 수강하며 정리하는 것이라, CS50에서만 제공되는 프로그램이 예시로 작성되었다.  그래도 프론트엔드 공부를 하면서 다른 IDE에서도 디버깅을 해봤고, 자바스크립트와 관련된 테스트, 스타일 라이브러리를 알기 때문에 그 외에 것도 잘 적용할 수 있을 거라 생각한다.

이 강의의 의의는 애매하게 아는 것을 좀 더 깔끔하게 정리하는 데 있다.

또한, 강의 후반부로 갈수록 CS50에 대한 의존도가 낮아진다고 하니 기대 중이다.

<br/><br/>

## 출처
[부스트코스 CS50](www.boostcourse.org/cs112)
